# SteamProps - IF-97 Calculator

Калькулятор термодинамических свойств воды и пара на основе стандарта IAPWS IF-97.

## Возможности

- Расчет всех термодинамических свойств воды и пара
- Поддержка всех регионов IF-97 (Region 1, 2, 3, 4, 5)
- Автоматический выбор региона
- Расчет транспортных свойств (вязкость, теплопроводность)
- Два режима расчета: TP (температура-давление) и HS (энтальпия-энтропия)
- Современный веб-интерфейс, графический интерфейс (GUI) и командная строка (CLI)
- Высокая точность расчетов согласно стандарту IF-97

## Установка

### Требования

- Go 1.19 или выше
- Для GUI: библиотека Fyne (устанавливается автоматически)

### Сборка

#### Использование Makefile (рекомендуется)

```bash
# Сборка всех компонентов
make build

# Сборка только CLI приложения
make build-cli

# Сборка только GUI приложения
make build-gui

# Запуск тестов
make test

# Запуск тестов с покрытием
make test-coverage

# Очистка собранных файлов
make clean
```

#### Ручная сборка

```bash
# CLI приложение
go build -o steamprops-cli cmd/main.go

# Сборка веб-приложения
make build-web

# Запуск веб-приложения
make run-web
```

## Использование

### CLI приложение

```bash
# Базовое использование
./steamprops-cli -t 200 -p 101325

# С указанием региона
./steamprops-cli -t 200 -p 101325 -region 2

# Режим HS (энтальпия-энтропия)
./steamprops-cli -mode hs -h 2000 -s 5

# Справка
./steamprops-cli -h
```

#### Параметры CLI

- `-t`: Температура, °C (по умолчанию: 200)
- `-p`: Давление, Па (по умолчанию: 4e+07)
- `-mode`: Режим расчета: tp или hs (по умолчанию: tp)
- `-region`: Регион IF-97: auto, 1, 2, 3, 5 (по умолчанию: auto)
- `-h`: Энтальпия, кДж/кг (для режима hs)
- `-s`: Энтропия, кДж/(кг·К) (для режима hs)

### Веб-приложение (рекомендуется)

```bash
# Сборка и запуск
make build-web
make run-web

# Или запуск на другом порту
./steamprops-web 3000
```

Откройте http://localhost:8080 в браузере.

**Веб-интерфейс предоставляет:**
- Современный адаптивный дизайн
- Интерактивные формы ввода
- Автоматическую конвертацию единиц измерения
- Визуализацию результатов в виде графиков
- Историю расчетов с возможностью сохранения
- REST API для интеграции с другими приложениями
- Поддержку всех режимов расчета (TP/HS)
- Информационные панели с описанием регионов IF-97

### GUI приложение

```bash
./steamprops-gui
```

GUI приложение предоставляет десктопный интерфейс для:
- Ввода параметров расчета
- Выбора режима расчета (TP/HS)
- Отображения результатов в табличном виде
- Просмотра истории расчетов
- Конвертации единиц измерения

## Регионы IF-97

- **Region 1**: Сжатая жидкость (T < 647.096 K, p > psat)
- **Region 2**: Перегретый пар (T < 647.096 K, p < psat или T ≥ 647.096 K, T < 1073.15 K)
- **Region 3**: Критическая область (T ≥ 623.15 K, p ≥ 16.529 MPa)
- **Region 4**: Линия насыщения (T < 647.096 K, p = psat)
- **Region 5**: Высокотемпературный газ (T > 1073.15 K, p ≤ 50 MPa)

## Рассчитываемые свойства

### Термодинамические свойства
- Удельный объем, м³/кг
- Плотность, кг/м³
- Удельная энтальпия, кДж/кг
- Удельная энтропия, кДж/(кг·К)
- Удельная внутренняя энергия, кДж/кг
- Удельная изобарная теплоемкость, кДж/(кг·К)
- Удельная изохорная теплоемкость, кДж/(кг·К)
- Скорость звука, м/с

### Транспортные свойства
- Динамическая вязкость, Па·с
- Кинематическая вязкость, м²/с
- Теплопроводность, Вт/(м·К)

## REST API

Веб-приложение предоставляет REST API для интеграции с другими системами:

### POST /api/calculate

Выполняет расчет термодинамических свойств.

**Запрос (TP режим):**
```json
{
  "mode": "TP",
  "temperature": 200,
  "pressure": 101325,
  "region": "auto"
}
```

**Запрос (HS режим):**
```json
{
  "mode": "HS",
  "enthalpy": 2000,
  "entropy": 5,
  "region": "auto"
}
```

**Ответ:**
```json
{
  "success": true,
  "properties": {
    "temperature": 200,
    "pressure": 101325,
    "density": 0.4664315188225818,
    "specific_volume": 2.143937447718608,
    "specific_enthalpy": 2875.4136984379634,
    "specific_entropy": 7.829386917493997,
    "specific_internal_energy": 2658.1792365478755,
    "specific_isobaric_heat_capacity": 1.499519213586393,
    "specific_isochoric_heat_capacity": 1.499519213586393,
    "speed_of_sound": 533.6491186698364,
    "dynamic_viscosity": "2.55e-05 Па·с",
    "kinematic_viscosity": "5.46e-05 м²/с",
    "thermal_conductivity": "0.040 Вт/(м·К)",
    "phase": "Перегретый пар",
    "region": 2
  }
}
```

## Тестирование

Проект имеет высокое покрытие тестами (более 80%):

```bash
# Запуск всех тестов
go test ./...

# Запуск тестов с покрытием
go test -coverprofile=coverage.out ./...
go tool cover -html=coverage.out -o coverage.html
```

## Архитектура

```
cmd/
├── main.go          # CLI приложение
├── gui/
│   ├── main.go      # GUI приложение
│   ├── components.go # GUI компоненты
│   └── nogl.go      # Software rendering
└── web/
    └── main.go      # Веб-сервер

web/
├── templates/
│   └── index.html   # HTML шаблон
└── static/
    ├── css/
    │   └── style.css # CSS стили
    ├── js/
    │   └── app.js    # JavaScript логика
    └── images/       # Изображения

internal/
├── steamprops/      # Основной калькулятор
└── calc_core/       # Ядро расчетов
    ├── region1/     # Region 1 (сжатая жидкость)
    ├── region2/     # Region 2 (перегретый пар)
    ├── region3/     # Region 3 (критическая область)
    ├── region4/     # Region 4 (линия насыщения)
    ├── region5/     # Region 5 (высокотемпературный газ)
    ├── bounds/      # Границы между регионами
    ├── transport/   # Транспортные свойства
    ├── validation/  # Валидация входных данных
    └── cache/       # Кэширование результатов
```

## Лицензия

MIT License

## Автор

SteamProps Calculator Team