# SteamProps

Калькулятор термодинамических свойств воды и пара по стандарту IAPWS IF-97.

## Описание

SteamProps - это профессиональный инструмент для расчета термодинамических свойств воды и пара в соответствии со стандартом IAPWS IF-97. Проект реализует все пять регионов IF-97 и включает как консольное, так и графическое приложение.

## Возможности

- ✅ **Полная реализация IAPWS IF-97**: Все 5 регионов
- ✅ **Транспортные свойства**: Динамическая и кинематическая вязкость, теплопроводность
- ✅ **Обратные вычисления**: Расчет давления по энтальпии и энтропии (Region 3)
- ✅ **Графический интерфейс**: Современный GUI на Fyne
- ✅ **Консольное приложение**: Для автоматизации и скриптов
- ✅ **Множественные единицы измерения**: Температура, давление, энтальпия, энтропия
- ✅ **Валидация входных данных**: Проверка корректности и диапазонов
- ✅ **Высокая точность**: Соответствие стандарту IAPWS IF-97

## Установка

### Требования

- Go 1.25 или выше
- Linux, macOS или Windows

### Сборка из исходного кода

```bash
# Клонирование репозитория
git clone https://github.com/somepgs/steamprops.git
cd steamprops

# Установка зависимостей
go mod download

# Сборка консольного приложения
go build -o steamprops cmd/main.go

# Сборка GUI приложения
go build -o steamprops-gui cmd/gui/main.go

# Запуск тестов
go test ./...

# Проверка покрытия тестами
go test ./... -cover
```

## Использование

### Консольное приложение

```bash
# Расчет по температуре и давлению
./steamprops -mode tp -t 200 -p 40000000

# Расчет по энтальпии и энтропии
./steamprops -mode hs -h 2000 -s 5.0

# Принудительный выбор региона
./steamprops -mode tp -t 200 -p 40000000 -region 1

# Справка
./steamprops -help
```

**Параметры:**
- `-mode`: Режим расчета (`tp` - по температуре и давлению, `hs` - по энтальпии и энтропии)
- `-t`: Температура в °C
- `-p`: Давление в Па
- `-h`: Энтальпия в кДж/кг (для режима hs)
- `-s`: Энтропия в кДж/(кг·К) (для режима hs)
- `-region`: Регион IF-97 (`auto`, `1`, `2`, `3`, `5`)

### GUI приложение

```bash
./steamprops-gui
```

**Возможности GUI:**
- Выбор режима расчета (TP или HS)
- Множественные единицы измерения
- Абсолютное и избыточное давление
- Копирование результатов в буфер обмена
- Индикация фазы вещества (вода/пар)

### Программный интерфейс

```go
package main

import (
    "fmt"
    "github.com/somepgs/steamprops/internal/calc_core"
    "github.com/somepgs/steamprops/internal/calc_core/region1"
)

func main() {
    // Расчет свойств в Region 1
    props, err := region1.Calculate(200.0, 40e6) // 200°C, 40 МПа
    if err != nil {
        fmt.Printf("Ошибка: %v\n", err)
        return
    }
    
    fmt.Printf("Плотность: %.6f кг/м³\n", props.Density)
    fmt.Printf("Энтальпия: %.6f кДж/кг\n", props.SpecificEnthalpy)
    fmt.Printf("Энтропия: %.6f кДж/(кг·К)\n", props.SpecificEntropy)
}
```

## Регионы IF-97

| Регион | Описание | Диапазон применения |
|--------|----------|-------------------|
| **Region 1** | Сжатая жидкость | T ≤ 623.15 K, p ≤ 100 МПа |
| **Region 2** | Пар и перегретый пар | T ≤ 1073.15 K, p ≤ 100 МПа |
| **Region 3** | Критическая область | 623.15 K < T < 1073.15 K, p ≤ 100 МПа |
| **Region 4** | Линия насыщения | T ≤ 647.096 K |
| **Region 5** | Высокотемпературная область | 1073.15 K < T ≤ 2273.15 K, p ≤ 50 МПа |

## Термодинамические свойства

### Основные свойства
- **Удельный объем** (v) - м³/кг
- **Плотность** (ρ) - кг/м³
- **Удельная внутренняя энергия** (u) - кДж/кг
- **Удельная энтальпия** (h) - кДж/кг
- **Удельная энтропия** (s) - кДж/(кг·К)

### Теплоемкости
- **Удельная изобарная теплоемкость** (cp) - кДж/(кг·К)
- **Удельная изохорная теплоемкость** (cv) - кДж/(кг·К)

### Транспортные свойства
- **Динамическая вязкость** (μ) - Па·с
- **Кинематическая вязкость** (ν) - м²/с
- **Теплопроводность** (λ) - Вт/(м·К)

### Другие свойства
- **Скорость звука** (w) - м/с

## Единицы измерения

### Температура
- °C (градусы Цельсия)
- K (кельвины)

### Давление
- Па (паскали)
- МПа (мегапаскали)
- бар
- атм (атмосферы)
- кгс/см²
- мм рт.ст.
- мм вод.ст.

### Энтальпия и энтропия
- кДж/кг
- кДж/(кг·К)

## Примеры расчетов

### Пример 1: Сжатая жидкость (Region 1)
```bash
./steamprops -mode tp -t 200 -p 40000000
```
**Результат:**
- Плотность: 866.04 кг/м³
- Энтальпия: 856.01 кДж/кг
- Энтропия: 2.3308 кДж/(кг·К)

### Пример 2: Перегретый пар (Region 2)
```bash
./steamprops -mode tp -t 500 -p 1000000
```
**Результат:**
- Плотность: 0.4406 кг/м³
- Энтальпия: 3478.5 кДж/кг
- Энтропия: 7.7642 кДж/(кг·К)

### Пример 3: Критическая область (Region 3)
```bash
./steamprops -mode hs -h 2000 -s 4.5
```
**Результат:**
- Давление: 25.583 МПа
- Температура: 650.0 K
- Плотность: 435.0 кг/м³

## Тестирование

```bash
# Запуск всех тестов
go test ./...

# Запуск тестов с покрытием
go test ./... -cover

# Запуск тестов конкретного пакета
go test ./internal/calc_core/region1

# Запуск бенчмарков
go test ./... -bench=.

# Запуск тестов с подробным выводом
go test ./... -v
```

## Новая архитектура (v2.0)

Проект полностью переписан с нуля с использованием современных принципов разработки:

### Ключевые улучшения:

- **Чистая архитектура**: Четкое разделение ответственности между слоями
- **Профессиональный GUI**: Современный интерфейс с табличным отображением результатов
- **Улучшенный HS калькулятор**: Правильная обработка ошибок и определение регионов
- **Полное тестирование**: Покрытие тестами всех основных компонентов
- **Расширяемость**: Легко добавлять новые функции и регионы
- **Производительность**: Оптимизированные вычисления и кэширование

### Основные компоненты:

- **`steamprops.Calculator`**: Главный калькулятор с единым API
- **`steamprops.InputData`**: Структурированные входные данные с валидацией
- **`steamprops.Result`**: Результаты расчета с полной информацией
- **GUI компоненты**: Модульные панели ввода, результатов и управления

```
steamprops/
├── cmd/                    # Исполняемые приложения
│   ├── main.go            # Консольное приложение
│   └── gui/               # GUI приложение
│       ├── main.go        # Основной GUI
│       ├── components.go  # GUI компоненты
│       └── nogl.go        # Software rendering
├── internal/              # Внутренние пакеты
│   ├── steamprops/        # Основной API
│   │   ├── calculator.go  # Главный калькулятор
│   │   └── calculator_test.go # Тесты калькулятора
│   └── calc_core/         # Вычислительное ядро
│       ├── interfaces.go  # Интерфейсы и типы
│       ├── bounds/        # Границы регионов
│       ├── region1/       # Region 1 (сжатая жидкость)
│       ├── region2/       # Region 2 (пар)
│       ├── region3/       # Region 3 (критическая область)
│       ├── region4/       # Region 4 (линия насыщения)
│       ├── region5/       # Region 5 (высокотемпературная область)
│       ├── transport/     # Транспортные свойства
│       ├── validation/    # Валидация входных данных
│       └── cache/         # Кэширование результатов
├── go.mod                 # Зависимости Go
├── go.sum                 # Хеши зависимостей
└── README.md              # Документация
```

## Точность и валидация

- **Точность**: Соответствует стандарту IAPWS IF-97
- **Валидация**: Проверка входных данных и диапазонов
- **Тестирование**: Покрытие тестами >80%
- **Эталонные данные**: Сравнение с официальными таблицами IAPWS

## Ограничения

- Применимо только для чистой воды (H₂O)
- Диапазоны согласно стандарту IF-97
- Транспортные свойства: точность ±5% в большинстве случаев

## Вклад в проект

Мы приветствуем вклад в развитие проекта! Пожалуйста:

1. Форкните репозиторий
2. Создайте ветку для новой функции
3. Добавьте тесты для нового кода
4. Убедитесь, что все тесты проходят
5. Создайте Pull Request

## Лицензия

MIT License - см. файл LICENSE для подробностей.

## Ссылки

- [IAPWS IF-97](https://www.iapws.org/relguide/IF97-Rev.html)
- [IAPWS Transport Properties](https://www.iapws.org/relguide/Trans.html)
- [Fyne GUI Framework](https://fyne.io/)

## Поддержка

Если у вас есть вопросы или проблемы:

1. Проверьте [Issues](https://github.com/yourusername/steamprops/issues)
2. Создайте новый Issue с подробным описанием
3. Приложите примеры входных данных и ожидаемых результатов

---

**SteamProps** - надежный инструмент для термодинамических расчетов воды и пара.